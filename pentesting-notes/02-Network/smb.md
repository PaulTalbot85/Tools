# SMB Enumeration & Exploitation (TCP/445)

## Nmap NSE

sudo nmap -p 445 -sV -sC -O <TARGET_IP>
nmap -p445 --script smb-os-discovery <TARGET_IP>
nmap -p445 --script smb-protocols,smb-security-mode <TARGET_IP>
nmap -p445 --script smb-enum-sessions <TARGET_IP>
nmap -p445 --script smb-enum-shares <TARGET_IP>
nmap -p445 --script smb-enum-users <TARGET_IP>
nmap -p445 --script smb-server-stats <TARGET_IP>
nmap -p445 --script "smb-enum-*,smb-ls" <TARGET_IP>
nmap -p445 --script smb-vuln-* <TARGET_IP>
Null / Auth Sessions

smbclient -L //<TARGET_IP> -N
smbclient -L //<TARGET_IP> -U <USER>
smbclient //<TARGET_IP>/<SHARE> -U "<USER>%<PW>"
smbmap

smbmap -H <TARGET_IP> -u guest -p ""
smbmap -H <TARGET_IP> -u <USER> -p '<PW>'
smbmap -H <TARGET_IP> -u <USER> -p '<PW>' -x 'ipconfig'
smbmap -H <TARGET_IP> -u <USER> -p '<PW>' -L
smbmap -H <TARGET_IP> -u <USER> -p '<PW>' -r 'C$'
smbmap -H <TARGET_IP> -u <USER> -p '<PW>' --upload '/root/file' 'C$\file'
smbmap -H <TARGET_IP> -u <USER> -p '<PW>' --download 'C$\flag.txt'
